# Terraform Remote Backend

Terraform [remote](https://www.terraform.io/docs/backends/types/remote.html) backend helps users
store Terraform [state](https://www.terraform.io/docs/state/index.html) and run Terraform commands
remotely using [Terraform Cloud](https://www.terraform.io/docs/cloud/index.html).

**Note: CDK for Terraform currently doesn't support specifying remote backends using programming
languages like TypeScript and Python.**

To use a remote backend, users can go to the generated Terraform JSON configuration and add the
remote backend JSON configuration. Here is an example showing the use of remote backend configuration
for Terraform Cloud.

The `cdktf.out` directory contains our synthesized code that can be generated by running `cdktf synth` in
any CDK for Terraform project.

```bash
cd cdktf.out
tree .
.
├── examplesimple.tf.json
└── providers.tf.json
```

A Terraform [JSON configuration for a remote backend](https://www.terraform.io/docs/configuration/syntax-json.html#terraform-blocks)
can be defined in two ways:

1. Use a [Stack Escape Hatch](./escape-hatch.md) to define a backend. It will synthesize
   to a JSON configuration in the autogenerated `*.tf.json` file.
   ```typescript
   stack.addOverride('terraform.backend', {
     remote: {
       hostname: 'app.terraform.io',
       organization: 'company',
       workspaces: {
         name: 'my-app-prod'
       }
     }
   });
   ```

2. Create a JSON file such as `remote.tf.json` in `cdktf.out` directory.
   ```json
   {
       "terraform": {
           "backend": {
               "remote": {
                   "hostname": "app.terraform.io",
                   "organization": "company",
                   "workspaces": {
                       "name": "my-app-prod"
                   }
               }
           }
       }
   }
   ```

Running `terraform init` will initialize Terraform remote backend.

```shell
$ terraform init
```

Users can then run `terraform plan` and `terraform apply` to manage their infrastructure.
